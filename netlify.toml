[build]
  publish = "build"
  command = "npm run build"

# ============================================
# BLOG REDIRECTS - Redirect non-existent locale blogs to English blog
# MUST use force = true to override any existing files
# ============================================

# Blog archive pages -> English blog archive
[[redirects]]
  from = "/es/blog/archive"
  to = "/blog/archive"
  status = 301
  force = true

[[redirects]]
  from = "/de/blog/archive"
  to = "/blog/archive"
  status = 301
  force = true

[[redirects]]
  from = "/pt/blog/archive"
  to = "/blog/archive"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/blog/archive"
  to = "/blog/archive"
  status = 301
  force = true

# Blog tag pages -> English blog
[[redirects]]
  from = "/es/blog/tags/*"
  to = "/blog/tags/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/de/blog/tags/*"
  to = "/blog/tags/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/pt/blog/tags/*"
  to = "/blog/tags/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/blog/tags/*"
  to = "/blog/tags/:splat"
  status = 301
  force = true

# Blog author pages -> English blog
[[redirects]]
  from = "/es/blog/authors/*"
  to = "/blog/"
  status = 301
  force = true

[[redirects]]
  from = "/de/blog/authors/*"
  to = "/blog/"
  status = 301
  force = true

[[redirects]]
  from = "/pt/blog/authors/*"
  to = "/blog/"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/blog/authors/*"
  to = "/blog/"
  status = 301
  force = true

# Blog pagination pages -> English blog
[[redirects]]
  from = "/es/blog/page/*"
  to = "/blog/"
  status = 301
  force = true

[[redirects]]
  from = "/de/blog/page/*"
  to = "/blog/"
  status = 301
  force = true

[[redirects]]
  from = "/pt/blog/page/*"
  to = "/blog/"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/blog/page/*"
  to = "/blog/"
  status = 301
  force = true

# Spanish blog posts -> English blog
[[redirects]]
  from = "/es/blog/*"
  to = "/blog/:splat"
  status = 301
  force = true

# German blog posts -> English blog
[[redirects]]
  from = "/de/blog/*"
  to = "/blog/:splat"
  status = 301
  force = true

# Portuguese blog posts -> English blog
[[redirects]]
  from = "/pt/blog/*"
  to = "/blog/:splat"
  status = 301
  force = true

# Chinese blog posts -> English blog
[[redirects]]
  from = "/zh-Hans/blog/*"
  to = "/blog/:splat"
  status = 301
  force = true

# ============================================
# TAGS IN LOCALES - Redirect locale tags to English tags
# ============================================

[[redirects]]
  from = "/es/tags/*"
  to = "/tags/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/de/tags/*"
  to = "/tags/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/pt/tags/*"
  to = "/tags/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/tags/*"
  to = "/tags/:splat"
  status = 301
  force = true

# ============================================
# CATEGORY PAGES IN LOCALES - Redirect to English category
# ============================================

[[redirects]]
  from = "/es/category/*"
  to = "/category/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/de/category/*"
  to = "/category/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/pt/category/*"
  to = "/category/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/category/*"
  to = "/category/:splat"
  status = 301
  force = true

# ============================================
# SPECIAL PAGES IN LOCALES - Missing pages redirect to home
# ============================================

# Country VAT name pages
[[redirects]]
  from = "/es/country-vat-name"
  to = "/es/"
  status = 301
  force = true

[[redirects]]
  from = "/de/country-vat-name"
  to = "/de/"
  status = 301
  force = true

[[redirects]]
  from = "/pt/country-vat-name"
  to = "/pt/"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/country-vat-name"
  to = "/zh-Hans/"
  status = 301
  force = true

# ============================================
# ROOT-LEVEL EXTERNAL PAGES - Redirect to main site
# ============================================

# Blog posts at root level (outside /docs/)
[[redirects]]
  from = "/business-tax-compliance-guide-2026"
  to = "https://lookuptax.com/docs/blog/business-tax-compliance-guide-2026"
  status = 301
  force = true

# ============================================
# EXTERNAL PAGE REDIRECTS - Pages outside /docs/
# ============================================

# Validator pages -> main lookuptax.com site
[[redirects]]
  from = "/validate/*"
  to = "https://lookuptax.com/validate/:splat"
  status = 301
  force = true

# Industries pages -> main lookuptax.com site
[[redirects]]
  from = "/industries/*"
  to = "https://lookuptax.com/industries/:splat"
  status = 301
  force = true

# Use cases pages -> main lookuptax.com site
[[redirects]]
  from = "/use-cases/*"
  to = "https://lookuptax.com/use-cases/:splat"
  status = 301
  force = true

# Demo page -> main lookuptax.com site
[[redirects]]
  from = "/demo"
  to = "https://lookuptax.com/demo"
  status = 301
  force = true

# Tag pages without /docs/ prefix
[[redirects]]
  from = "/tag/*"
  to = "/tags/:splat"
  status = 301
  force = true

# ============================================
# DOUBLE PATH FIXES - Fix malformed URLs
# ============================================

# Fix double locale paths (e.g., /docs/zh-Hans/zh-Hans/...)
[[redirects]]
  from = "/zh-Hans/zh-Hans/*"
  to = "/zh-Hans/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/es/es/*"
  to = "/es/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/de/de/*"
  to = "/de/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/pt/pt/*"
  to = "/pt/:splat"
  status = 301
  force = true

# Fix double /docs/ paths
[[redirects]]
  from = "/*/docs/*"
  to = "/:splat"
  status = 301
  force = true

# Fix double /tags/ paths
[[redirects]]
  from = "/*/tags/tags/*"
  to = "/:splat/tags/:splat"
  status = 301
  force = true

# ============================================
# CROSS-LOCALE PATH FIXES
# ============================================

# Portuguese URL with Spanish path -> redirect to Portuguese home
[[redirects]]
  from = "/pt/es/*"
  to = "/pt/"
  status = 301
  force = true

# Chinese URL with Spanish path -> redirect to Chinese home
[[redirects]]
  from = "/zh-Hans/es/*"
  to = "/zh-Hans/"
  status = 301
  force = true

# Spanish URL with Chinese path -> redirect to Spanish home
[[redirects]]
  from = "/es/zh-Hans/*"
  to = "/es/"
  status = 301
  force = true

# German URL with Chinese path -> redirect to German home
[[redirects]]
  from = "/de/zh-Hans/*"
  to = "/de/"
  status = 301
  force = true

# Portuguese URL with Chinese path -> redirect to Portuguese home
[[redirects]]
  from = "/pt/zh-Hans/*"
  to = "/pt/"
  status = 301
  force = true

# German URL with Spanish path -> redirect to German home
[[redirects]]
  from = "/de/es/*"
  to = "/de/"
  status = 301
  force = true

# ============================================
# ENGLISH SLUGS IN NON-ENGLISH LOCALES
# These pages use English URL patterns but don't have translations
# ============================================

# Tax ID guide pages with English slugs
[[redirects]]
  from = "/es/tax-identification-number/*-tax-id-guide"
  to = "/tax-identification-number/:splat-tax-id-guide"
  status = 301
  force = true

[[redirects]]
  from = "/de/tax-identification-number/*-tax-id-guide"
  to = "/tax-identification-number/:splat-tax-id-guide"
  status = 301
  force = true

[[redirects]]
  from = "/pt/tax-identification-number/*-tax-id-guide"
  to = "/tax-identification-number/:splat-tax-id-guide"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/tax-identification-number/*-tax-id-guide"
  to = "/tax-identification-number/:splat-tax-id-guide"
  status = 301
  force = true

# How-to-verify pages with English slugs -> English version
[[redirects]]
  from = "/es/how-to-verify/*"
  to = "/how-to-verify/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/de/how-to-verify/*"
  to = "/how-to-verify/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/pt/how-to-verify/*"
  to = "/how-to-verify/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/how-to-verify/*"
  to = "/how-to-verify/:splat"
  status = 301
  force = true

# Explainers pages with English slugs -> English version
[[redirects]]
  from = "/es/explainers/*"
  to = "/explainers/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/de/explainers/*"
  to = "/explainers/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/pt/explainers/*"
  to = "/explainers/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/explainers/*"
  to = "/explainers/:splat"
  status = 301
  force = true

# Einvoicing pages with English slugs -> English version
[[redirects]]
  from = "/es/einvoicing/*"
  to = "/einvoicing/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/de/einvoicing/*"
  to = "/einvoicing/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/pt/einvoicing/*"
  to = "/einvoicing/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/einvoicing/*"
  to = "/einvoicing/:splat"
  status = 301
  force = true

# Glossary pages with English slugs -> English version
[[redirects]]
  from = "/es/glossary/*"
  to = "/glossary/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/de/glossary/*"
  to = "/glossary/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/pt/glossary/*"
  to = "/glossary/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/glossary/*"
  to = "/glossary/:splat"
  status = 301
  force = true

# Sales-tax pages with English slugs -> English version
[[redirects]]
  from = "/pt/sales-tax/*"
  to = "/sales-tax/:splat"
  status = 301
  force = true

# VAT country pages with English slugs -> English version
[[redirects]]
  from = "/es/vat/*"
  to = "/vat/:splat"
  status = 301
  force = true

# Doc country pages -> English version
[[redirects]]
  from = "/es/docs/country/*"
  to = "/country/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/pt/docs/country/*"
  to = "/country/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/docs/country/*"
  to = "/country/:splat"
  status = 301
  force = true

# einvoicing-status-networks page -> English version (all locales)
[[redirects]]
  from = "/es/einvoicing-status-networks"
  to = "/einvoicing-status-networks"
  status = 301
  force = true

[[redirects]]
  from = "/de/einvoicing-status-networks"
  to = "/einvoicing-status-networks"
  status = 301
  force = true

[[redirects]]
  from = "/pt/einvoicing-status-networks"
  to = "/einvoicing-status-networks"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/einvoicing-status-networks"
  to = "/einvoicing-status-networks"
  status = 301
  force = true

# check-vat-number page -> English version (all locales)
[[redirects]]
  from = "/es/check-vat-number-free-links-to-official-national-database-search-VAT-number"
  to = "/check-vat-number-free-links-to-official-national-database-search-VAT-number"
  status = 301
  force = true

[[redirects]]
  from = "/de/check-vat-number-free-links-to-official-national-database-search-VAT-number"
  to = "/check-vat-number-free-links-to-official-national-database-search-VAT-number"
  status = 301
  force = true

[[redirects]]
  from = "/pt/check-vat-number-free-links-to-official-national-database-search-VAT-number"
  to = "/check-vat-number-free-links-to-official-national-database-search-VAT-number"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/check-vat-number-free-links-to-official-national-database-search-VAT-number"
  to = "/check-vat-number-free-links-to-official-national-database-search-VAT-number"
  status = 301
  force = true

# contact-us page -> English version (all locales)
[[redirects]]
  from = "/es/contact-us"
  to = "/contact-us"
  status = 301
  force = true

[[redirects]]
  from = "/de/contact-us"
  to = "/contact-us"
  status = 301
  force = true

[[redirects]]
  from = "/pt/contact-us"
  to = "/contact-us"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/contact-us"
  to = "/contact-us"
  status = 301
  force = true

# External pages - integrations, blog at root
[[redirects]]
  from = "/integrations/*"
  to = "https://lookuptax.com/integrations/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/blog/*"
  to = "https://lookuptax.com/docs/blog/:splat"
  status = 301
  force = true

# ============================================
# ROOT-LEVEL TRANSLATED SLUGS (no locale prefix)
# These are translated slugs that appeared without locale
# ============================================

# Spanish slugs at root -> Spanish version
[[redirects]]
  from = "/como-verificar/*"
  to = "/es/como-verificar/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/numero-identificacion-fiscal/*"
  to = "/es/numero-identificacion-fiscal/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/explicadores/*"
  to = "/es/explicadores/:splat"
  status = 301
  force = true

# Chinese slugs at root -> Chinese version
[[redirects]]
  from = "/shuiwu-shibie-haoma/*"
  to = "/zh-Hans/shuiwu-shibie-haoma/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/ruhe-yanzheng/*"
  to = "/zh-Hans/ruhe-yanzheng/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/jieshipage/*"
  to = "/zh-Hans/jieshipage/:splat"
  status = 301
  force = true

# German slugs at root -> German version
[[redirects]]
  from = "/erklaerung/*"
  to = "/de/erklaerung/:splat"
  status = 301
  force = true

[[redirects]]
  from = "/wie-man-ueberprueft/*"
  to = "/de/wie-man-ueberprueft/:splat"
  status = 301
  force = true

# ============================================
# CROSS-LOCALE SLUG MIXING (locale A with locale B slugs)
# ============================================

# German locale with Spanish slugs -> German home
[[redirects]]
  from = "/de/como-verificar/*"
  to = "/de/"
  status = 301
  force = true

[[redirects]]
  from = "/de/numero-identificacion-fiscal/*"
  to = "/de/"
  status = 301
  force = true

# Portuguese locale with Spanish slugs -> Portuguese home
[[redirects]]
  from = "/pt/como-verificar/*"
  to = "/pt/"
  status = 301
  force = true

[[redirects]]
  from = "/pt/numero-identificacion-fiscal/*"
  to = "/pt/"
  status = 301
  force = true

[[redirects]]
  from = "/pt/explicadores/*"
  to = "/pt/"
  status = 301
  force = true

# Chinese locale with Spanish slugs -> Chinese home
[[redirects]]
  from = "/zh-Hans/como-verificar/*"
  to = "/zh-Hans/"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/numero-identificacion-fiscal/*"
  to = "/zh-Hans/"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/explicadores/*"
  to = "/zh-Hans/"
  status = 301
  force = true

# German locale with Chinese slugs -> German home
[[redirects]]
  from = "/de/ruhe-yanzheng/*"
  to = "/de/"
  status = 301
  force = true

[[redirects]]
  from = "/de/shuiwu-shibie-haoma/*"
  to = "/de/"
  status = 301
  force = true

# Portuguese locale with Chinese slugs -> Portuguese home
[[redirects]]
  from = "/pt/jieshipage/*"
  to = "/pt/"
  status = 301
  force = true

[[redirects]]
  from = "/pt/shuiwu-shibie-haoma/*"
  to = "/pt/"
  status = 301
  force = true

# Spanish locale with Chinese slugs -> Spanish home
[[redirects]]
  from = "/es/jieshipage/*"
  to = "/es/"
  status = 301
  force = true

[[redirects]]
  from = "/es/shuiwu-shibie-haoma/*"
  to = "/es/"
  status = 301
  force = true

# Portuguese locale with German slugs -> Portuguese home
[[redirects]]
  from = "/pt/erklaerung/*"
  to = "/pt/"
  status = 301
  force = true

# Chinese locale with German slugs -> Chinese home
[[redirects]]
  from = "/zh-Hans/erklaerung/*"
  to = "/zh-Hans/"
  status = 301
  force = true

# Spanish locale with German slugs -> Spanish home
[[redirects]]
  from = "/es/umsatzsteuer-identifikationsnummer-pruefen"
  to = "/es/"
  status = 301
  force = true

# German locale with localized slugs from other locales
[[redirects]]
  from = "/de/wie-man-ueberprueft/*"
  to = "/de/"
  status = 301
  force = true

# ============================================
# MALFORMED DOUBLE-DOCS PATHS
# ============================================

# Double slash paths
[[redirects]]
  from = "//docs/*"
  to = "/:splat"
  status = 301
  force = true

# Locale + /docs/intro patterns
[[redirects]]
  from = "/pt/docs/intro"
  to = "/pt/"
  status = 301
  force = true

[[redirects]]
  from = "/zh-Hans/docs/intro"
  to = "/zh-Hans/"
  status = 301
  force = true

[[redirects]]
  from = "//docs/intro"
  to = "/"
  status = 301
  force = true

[[redirects]]
  from = "//docs/es"
  to = "/es/"
  status = 301
  force = true

# Intro without content
[[redirects]]
  from = "/intro"
  to = "/"
  status = 301
  force = true

# ============================================
# EXTERNAL FILES AND PAGES
# ============================================

# llm.txt -> main site
[[redirects]]
  from = "/llm.txt"
  to = "https://lookuptax.com/llm.txt"
  status = 301
  force = true

# Tags at root level (without locale)
[[redirects]]
  from = "/tags/*"
  to = "/tags/:splat"
  status = 200

# ============================================
# LOCALE-SPECIFIC 404 PAGES
# ============================================

# Spanish locale - serve Spanish 404 for missing /es/ pages
[[redirects]]
  from = "/es/*"
  to = "/es/404.html"
  status = 404

# German locale - serve German 404 for missing /de/ pages
[[redirects]]
  from = "/de/*"
  to = "/de/404.html"
  status = 404

# Portuguese locale - serve Portuguese 404 for missing /pt/ pages
[[redirects]]
  from = "/pt/*"
  to = "/pt/404.html"
  status = 404

# Chinese locale - serve Chinese 404 for missing /zh-Hans/ pages
[[redirects]]
  from = "/zh-Hans/*"
  to = "/zh-Hans/404.html"
  status = 404

# Default English 404 for missing pages in root
[[redirects]]
  from = "/*"
  to = "/404.html"
  status = 404

# ============================================
# SECURITY HEADERS
# ============================================

[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-Content-Type-Options = "nosniff"
